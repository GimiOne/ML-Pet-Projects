# Классификатор пород собак

## Обзор
Проект **Классификатор пород собак**, разработанный с использованием **Keras 3** и модели **EfficientNetV2B0** на основе датасета [Stanford Dogs](http://vision.stanford.edu/aditya86/ImageNetDogs/). Цель проекта — создание эффективной и точной модели глубокого обучения для классификации 10 выбранных пород собак. Проект демонстрирует навыки работы с компьютерным зрением, предобработкой данных и тонкой настройкой моделей, что делает его ценным дополнением к портфолио для позиций в области анализа данных и машинного обучения.

## Основные функции
- **Трансферное обучение**: Использует предобученную модель EfficientNetV2B0 из Keras, адаптированную для классификации пород собак.
- **Предобработка данных**: Включает очистку поврежденных изображений, разделение данных на обучающую и валидационную выборки, а также аугментацию данных (вращение, сдвиг, отражение, изменение контрастности) для повышения обобщающей способности модели.
- **Обучение модели**: Реализован двухэтапный процесс обучения: начальное обучение с замороженными весами и тонкая настройка верхних слоев для оптимизации производительности.
- **Оценка и визуализация**: Предоставляет метрики (точность и потери) для обучающей и валидационной выборок, а также графики для анализа динамики обучения.
- **Предсказание**: Поддерживает классификацию одиночных изображений с указанием вероятности, продемонстрировано на тестовом изображении.

## Используемые технологии
- **Python**: Основной язык программирования.
- **Keras 3 / TensorFlow**: Фреймворк для построения и обучения модели.
- **EfficientNetV2B0**: Предобученная модель для трансферного обучения.
- **Matplotlib**: Для визуализации данных и результатов обучения.
- **NumPy**: Для работы с массивами данных.
- **OS / Shutil**: Для обработки файлов и структуры датасета.

## Установка и запуск
1. **Требования**:
   - Python 3.8+
   - Keras >= 3.5.0
   - TensorFlow
   - Matplotlib, NumPy

2. **Установка зависимостей**:
   ```bash
   pip install --upgrade keras>=3.5.0 tensorflow matplotlib numpy
   ```

3. **Скачивание датасета**:
   Датасет Stanford Dogs автоматически загружается и распаковывается с помощью команды в коде:
   ```bash
   wget https://storage.yandexcloud.net/academy.ai/stanford_dogs.zip
   unzip -qo "stanford_dogs.zip" -d ./dataset
   ```

4. **Запуск**:
   - Скачайте код из репозитория.
   - Выполните скрипт `dog_classifier.py`, который автоматически загрузит датасет, подготовит данные, обучит модель и выведет результаты.

## Структура проекта
- `dog_classifier.py`: Основной скрипт с кодом для загрузки данных, предобработки, обучения и оценки модели.
- `dataset/`: Папка с исходным датасетом Stanford Dogs.
- `selected_dataset/`: Папка с выбранными 10 породами для обучения.
- `best_model_pretrain.keras`: Сохраненная модель после начального обучения.
- `dogs_classification_fine_tune.keras`: Сохраненная модель после тонкой настройки.

## Результаты
- **Точность модели**: После начального обучения и тонкой настройки модель достигла точности ~90%+ на валидационной выборке.
- **Пример предсказания**: Модель успешно классифицирует одиночные изображения, например, определяя породу Affenpinscher с высокой вероятностью.
- Графики точности и потерь демонстрируют стабильное обучение и отсутствие сильного переобучения благодаря аугментации и правильной настройке гиперпараметров.

## Что я узнал
В ходе проекта я освоил трансферное обучение с использованием предобученных моделей, таких как EfficientNetV2, и понял, как адаптировать их для специфических задач. Я научился эффективно предобрабатывать изображения, включая очистку данных и аугментацию, чтобы улучшить обобщающую способность модели. Двухэтапное обучение (с заморозкой и тонкой настройкой) показало важность баланса между сохранением предобученных весов и адаптацией под конкретный датасет. Также я укрепил навыки работы с Keras/TensorFlow и визуализации результатов, что позволило мне глубже понять процесс создания и оптимизации моделей компьютерного зрения.

## Планы по улучшению
- Расширение количества пород для классификации.
- Эксперименты с другими архитектурами (например, ResNet, Vision Transformer).
- Добавление интерактивного интерфейса для загрузки изображений и получения предсказаний.
- Оптимизация гиперпараметров (learning rate, количество размороженных слоев) с помощью поиска по сетке.
